{% extends 'base.html' %}

{% block content %}
<h2>Mevcut Randevu Saatleri</h2>
<hr>

<form class="row g-2 align-items-end mb-3" method="get">
  <div class="col-auto">
    <label class="form-label">Başlangıç</label>
    <input type="date" class="form-control" name="start" value="{{ start }}">
  </div>
  <div class="col-auto">
    <label class="form-label">Bitiş</label>
    <input type="date" class="form-control" name="end" value="{{ end }}">
  </div>
  <div class="col-auto">
    <button class="btn btn-outline-primary" type="submit">Filtrele</button>
    <a class="btn btn-outline-secondary" href="{% url 'randevu_listesi' %}">Sıfırla</a>
  </div>
</form>

{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{% if message.tags %}{{ message.tags }}{% else %}info{% endif %} alert-dismissible fade show" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endfor %}
{% endif %}

{% if randevular %}
  <div class="list-group">
    {% for randevu in randevular %}
      <div class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
        {{ randevu.tarih_saat|date:"d F Y, l - H:i" }}
        <form method="POST" action="{% url 'randevu_al' randevu.id %}" style="display: inline;">
          {% csrf_token %}
          <button type="submit" class="btn btn-primary btn-sm">Randevu Al</button>
        </form>
      </div>
    {% endfor %}
  </div>

  <nav aria-label="Sayfalama" class="mt-3">
    <ul class="pagination">
      {% if randevular.has_previous %}
        <li class="page-item"><a class="page-link" href="?start={{ start }}&end={{ end }}&page={{ randevular.previous_page_number }}">Önceki</a></li>
      {% endif %}
      <li class="page-item disabled">
        <span class="page-link">Sayfa {{ randevular.number }} / {{ randevular.paginator.num_pages }}</span>
      </li>
      {% if randevular.has_next %}
        <li class="page-item"><a class="page-link" href="?start={{ start }}&end={{ end }}&page={{ randevular.next_page_number }}">Sonraki</a></li>
      {% endif %}
    </ul>
  </nav>
{% else %}
  <div class="alert alert-warning" role="alert">Uygun randevu bulunmamaktadır.</div>
{% endif %}
{% endblock %}
